<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Question Timer | KRID Labs</title>
<link rel="icon" type="image/png" href="favicon.png">
<link rel="icon" sizes="32x32" href="favicon.png">
<link rel="apple-touch-icon" href="favicon.png">

<style>
  :root{
    --bg: #0d1b2a;
    --panel: #1b263b;
    --btn: #415a77;
    --hover: #778da9;
    --text: #e0e1dd;
    --timer: #89cff0;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: "Segoe UI", Roboto, system-ui, -apple-system, "Helvetica Neue", Arial;
    background:var(--bg);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:20px;
  }

  header h1{
    margin:8px 0 12px;
    color:var(--timer);
    text-shadow:0 0 8px rgba(137,207,240,0.28);
    font-size:1.4rem;
    letter-spacing:0.3px;
  }

  #startStopBtn {
  width: 150px;
  background-color: #415a77;
  border: none;
  color: #e0e1dd;
  padding: 12px 20px;
  margin: 10px;
  font-size: 1.1em;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
}

#startStopBtn.active {
  background-color: #89cff0;
  box-shadow: 0 0 20px #89cff0;
  color: #0d1b2a;
}


  .container{
    width:100%;
    max-width:820px;
    background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
    border-radius:14px;
    padding:18px;
    box-shadow:0 10px 30px rgba(0,0,0,0.45);
    border:1px solid rgba(255,255,255,0.02);
    margin-top:6px;
  }

  .top{
    display:flex;
    justify-content:space-between;
    gap:12px;
    align-items:center;
    flex-wrap:wrap;
  }

  .left{
    display:flex;
    gap:14px;
    align-items:center;
  }

  .num-card{
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .num-card label{ font-size:0.9rem; color:#b8c3d0 }
  input[type="number"]{
    width:110px;
    padding:8px 10px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.03);
    background:var(--panel);
    color:var(--text);
    text-align:center;
    font-size:1rem;
  }

  .controls{
    display:flex;
    gap:10px;
    align-items:center;
  }

  .button{
    background:var(--btn);
    color:var(--text);
    padding:10px 14px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-size:0.95rem;
    transition:all .22s ease;
  }
  .button:hover{ background:var(--hover); box-shadow:0 0 12px rgba(119,141,169,0.14) }

  .progress-wrap{ margin-top:14px }
  .progress-bar{
    height:12px;
    background:var(--glass);
    border-radius:10px;
    overflow:hidden;
  }
  .progress-fill{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,var(--timer),var(--hover));
    transition:width .28s ease;
  }

  .center{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:12px;
    margin-top:18px;
    padding:8px 6px 18px;
  }

  .question-label{ font-size:1.05rem; color:var(--text); }
  .timer{
    font-size:3rem;
    font-weight:700;
    color:var(--timer);
    text-shadow:0 0 12px rgba(137,207,240,0.2);
  }

  .action-row{ display:flex; gap:10px; flex-wrap:wrap; width:100%; justify-content:center; margin-top:6px }
  .wide{ min-width:150px; }

  .small{ font-size:0.9rem; color:#9fb0c6 }

  .results{
    margin-top:18px;
    background:rgba(255,255,255,0.02);
    border-radius:10px;
    padding:12px;
  }

  table{ width:100%; border-collapse:collapse; color:var(--text) }
  th, td{ padding:8px; border-bottom:1px solid rgba(255,255,255,0.03); text-align:center }
  th{ color:var(--hover); font-weight:700; font-size:0.95rem }

  footer{
    margin-top:20px;
    color:#94a0b3;
    font-size:0.9rem;
    text-align:center;
    width:100%;
  }

  /* Modal (slide-up from bottom) */
  .setup-overlay{
    position:fixed; inset:0; display:flex; align-items:flex-end; justify-content:center;
    background:linear-gradient(rgba(2,6,10,0.45), rgba(2,6,10,0.55)); z-index:80;
  }
  .setup-card{
    width:100%;
    max-width:520px;
    background:var(--panel);
    border-radius:14px 14px 0 0;
    padding:20px;
    transform:translateY(100%);
    animation: slideUp .42s ease forwards;
    box-shadow:0 -8px 40px rgba(0,0,0,0.6);
    border-top:3px solid rgba(137,207,240,0.06);
  }
  @keyframes slideUp{
    from{ transform:translateY(100%); opacity:0 }
    to{ transform:translateY(0); opacity:1 }
  }

  .setup-row{ display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap }
  .setup-title{
    color:var(--timer);
    font-size:1.15rem;
    margin-bottom:8px;
    font-weight:700;
  }

  .modal-note{ color:#98a6b6; font-size:0.92rem; margin-top:8px }

  @media (max-width:620px){
    .timer{ font-size:2.4rem }
    input[type="number"]{ width:88px }
    .wide{ min-width:120px }
    .setup-card{ padding:16px }
  }
</style>
</head>
<body>
  <header><h1>Question Timer — KRID Labs</h1></header>

  <main class="container" id="app">
    <div class="top">
      <div class="left">
        <div class="num-card">
          <label class="small">Questions (editable before start)</label>
          <input id="numInput" type="number" min="1" max="200" value="10" />
        </div>
        <div class="small" style="margin-left:6px">Tip: press Space (desktop) or tap screen (mobile) to Start/Stop</div>
      </div>

      <div class="controls">
        <button class="button" id="openSetup">Change Setup</button>
        <button class="button" id="restartBtn">Restart Session</button>
      </div>
    </div>

    <div class="progress-wrap">
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    </div>

    <div class="center" id="testArea" style="display:none;">
      <div class="question-label" id="questionLabel">Question 1 of 10</div>
      <div class="timer" id="timer">0.00 s</div>

      <div class="action-row">
        <button class="button wide" id="pauseBtn">Pause Timer</button>
        <button class="button wide" id="skipBtn">Skip (mark Unattempted)</button>
        <button class="button wide" id="endBtn">End Test</button>
        <button id="startStopBtn" class="button">Start</button>

      </div>

      <div class="small">When paused, Space / tap won't start/stop — press Resume to continue.</div>
    </div>

    <div class="results" id="results" style="display:none"></div>
  </main>

  <footer>© 2025 KRID Labs | Built to Think. Designed to Feel. <br> Founded by <strong>Pranav Joshi</strong></footer>

  <!-- Slide-up setup modal -->
  <div class="setup-overlay" id="setupOverlay" style="display:flex">
    <div class="setup-card" role="dialog" aria-modal="true" aria-labelledby="setupTitle">
      <div class="setup-row">
        <div>
          <div class="setup-title" id="setupTitle">Start a new session</div>
          <div class="small">How many questions would you like to attempt?</div>
          <div style="margin-top:12px; display:flex; gap:10px; align-items:center;">
            <input id="modalNum" type="number" min="1" max="200" value="10" />
            <button class="button" id="startBtn">Start Test</button>
          </div>
          <div class="modal-note">You can change the number later by clicking "Change Setup".</div>
        </div>
        <div style="min-width:120px; text-align:right; align-self:center;">
          <div style="font-weight:700; color:var(--hover);">KRID Labs</div>
          <div class="small" style="margin-top:8px">Built to Think. Designed to Feel.</div>
        </div>
      </div>
    </div>
  </div>

<script>
(function(){
  // Elements
  const setupOverlay = document.getElementById('setupOverlay');
  const modalNum = document.getElementById('modalNum');
  const startBtn = document.getElementById('startBtn');
  const openSetup = document.getElementById('openSetup');
  const numInput = document.getElementById('numInput');
  const restartBtn = document.getElementById('restartBtn');

  const testArea = document.getElementById('testArea');
  const timerEl = document.getElementById('timer');
  const questionLabel = document.getElementById('questionLabel');
  const progressFill = document.getElementById('progressFill');
  const pauseBtn = document.getElementById('pauseBtn');
  const skipBtn = document.getElementById('skipBtn');
  const endBtn = document.getElementById('endBtn');
  const resultsDiv = document.getElementById('results');

  // State
  let totalQ = 10;
  let current = 1;
  let running = false;
  let paused = false;
  let startTs = 0;
  let pausedOffset = 0; // ms
  let timerId = null;
  let times = []; // ms or null for unattempted

  // Utils
  const fmt = ms => (ms/1000).toFixed(2) + ' s';

  function updateQuestionLabel(){
    questionLabel.textContent = `Question ${current} of ${totalQ}`;
    const pct = Math.round(((current - 1) / totalQ) * 100);
    progressFill.style.width = pct + '%';
  }

  function renderResults(showCard){
    // show results table
    const rows = times.map((t, i) => {
      if (t === null) return `<tr><td>${i+1}</td><td>Unattempted</td></tr>`;
      if (typeof t === 'number') return `<tr><td>${i+1}</td><td>${fmt(t)}</td></tr>`;
      return `<tr><td>${i+1}</td><td>Unattempted</td></tr>`;
    }).join('');
    const totalMs = times.reduce((a, t) => a + (typeof t === 'number' ? t : 0), 0);
    const attempted = times.filter(t => typeof t === 'number').length;
    const avgMs = attempted ? (totalMs / attempted) : 0;

    const html = `<h3>Results</h3>
      <table>
        <thead><tr><th>Question</th><th>Time</th></tr></thead>
        <tbody>${rows}</tbody>
      </table>
      <div style="margin-top:10px; font-size:0.95rem">Total (attempted): <strong>${fmt(totalMs)}</strong> • Average: <strong>${fmt(avgMs)}</strong></div>`;
    resultsDiv.innerHTML = html;
    resultsDiv.style.display = 'block';
    progressFill.style.width = '100%';
    if (showCard) showModal(false); // hide modal if open
  }

  function resetSession(opts={showModal:false}){
    // reset runtime state, but do not change saved UI number unless showModal true
    totalQ = parseInt(numInput.value) || 10;
    current = 1;
    running = false;
    paused = false;
    clearInterval(timerId);
    timerId = null;
    startTs = 0;
    pausedOffset = 0;
    times = Array(totalQ).fill(undefined);
    timerEl.textContent = '0.00 s';
    resultsDiv.style.display = 'none';
    testArea.style.display = 'none';
    updateQuestionLabel();
    if (opts.showModal) showModal(true);
  }

  function showModal(show=true){
    setupOverlay.style.display = show ? 'flex' : 'none';
    if (show) {
      // set modal input to current numInput
      modalNum.value = parseInt(numInput.value) || 10;
    }
  }

  // Start / Stop / Pause logic
  function startTimer(){
    if (running) return;
    running = true;
    paused = false;
    // compute start time with offset (if resuming)
    startTs = Date.now() - pausedOffset;
    timerId = setInterval(()=>{
      const elapsed = Date.now() - startTs;
      timerEl.textContent = fmt(elapsed);
    }, 80);
    pauseBtn.textContent = 'Pause Timer';
  }

  function stopTimerRecord(){
    if (!running && !paused) return;
    clearInterval(timerId);
    timerId = null;
    // If paused: pausedOffset contains ms elapsed, else compute elapsed now
    const elapsed = paused ? pausedOffset : (Date.now() - startTs);
    times[current - 1] = elapsed;
    timerEl.textContent = fmt(elapsed);
    running = false;
    paused = false;
    pausedOffset = 0;
    pauseBtn.textContent = 'Pause Timer';
  }

  function pauseToggle(){
    if (!running && !paused) return; // nothing to pause
    if (paused){
      // resume
      paused = false;
      startTimer(); // startTimer uses pausedOffset to continue
      pauseBtn.textContent = 'Pause Timer';
    } else {
      // pause
      paused = true;
      clearInterval(timerId);
      timerId = null;
      pausedOffset = Date.now() - startTs;
      pauseBtn.textContent = 'Resume Timer';
      timerEl.textContent = fmt(pausedOffset);
    }
  }

  function nextQuestion(){
    if (current < totalQ){
      current++;
      updateQuestionLabel();
      timerEl.textContent = '0.00 s';
      startTs = 0;
      pausedOffset = 0;
      paused = false;
      running = false;
      pauseBtn.textContent = 'Pause Timer';
    } else {
      // finished all questions
      // fill any undefined as unattempted
      for (let i=0;i<times.length;i++){
        if (typeof times[i] === 'undefined') times[i] = null;
      }
      renderResults(true);
    }
  }

  function skipCurrent(){
    // If running or paused, stop timer but mark as unattempted
    if (running || paused){
      clearInterval(timerId);
      timerId = null;
      running = false;
      paused = false;
    }
    times[current - 1] = null; // unattempted
    nextQuestion();
  }

  // toggle start/stop via space or tap (if not paused)
  function toggleStartStop(){
    if (paused) return; // while paused ignore toggles; user must resume
    if (running){
      stopTimerRecord();
      nextQuestion();
    } else {
      startTimer();
    }
  }

  // End test: stop everything, mark remaining undefined as unattempted
  function endTest(){
    if (running || paused){
      // if running, record current time; if paused, record paused offset as time
      if (running) {
        stopTimerRecord();
      } else if (paused) {
        // decide: paused but user ends -> record elapsed so far
        times[current - 1] = pausedOffset;
        paused = false;
        pausedOffset = 0;
        pauseBtn.textContent = 'Pause Timer';
      }
    }
    for (let i=0;i<times.length;i++){
      if (typeof times[i] === 'undefined') times[i] = null;
    }
    renderResults(true);
  }

  // Event bindings
  startBtn.addEventListener('click', ()=> {
    // take number from modal input, set main input too
    const n = parseInt(modalNum.value) || 10;
    numInput.value = n;
    // start session
    showModal(false);
    resetSession();
    totalQ = n;
    times = Array(totalQ).fill(undefined);
    testArea.style.display = 'flex';
    updateQuestionLabel();
  });

  openSetup.addEventListener('click', ()=> {
    // open modal with current count
    showModal(true);
  });

  restartBtn.addEventListener('click', ()=> {
    // reset session but keep user-visible number
    resetSession({showModal:false});
    numInput.value = parseInt(numInput.value) || 10;
    testArea.style.display = 'flex';
  });

  pauseBtn.addEventListener('click', pauseToggle);
  skipBtn.addEventListener('click', skipCurrent);
  endBtn.addEventListener('click', endTest);

  // keyboard: space toggles
  window.addEventListener('keydown', (e) => {
    if (e.code === 'Space' || e.key === ' ') {
      e.preventDefault();
      toggleStartStop();
    }
  });
  const startStopBtn = document.getElementById("startStopBtn");

function handleStartStop() {
  if (!isRunning) {
    startTimer();
    startStopBtn.textContent = "Stop";
    startStopBtn.classList.add("active");
  } else {
    stopTimer();
    startStopBtn.textContent = "Start";
    startStopBtn.classList.remove("active");
  }
}

if (/Mobi|Android/i.test(navigator.userAgent)) {
  // Only for mobile devices
  startStopBtn.style.display = "inline-block";
  startStopBtn.addEventListener("click", handleStartStop);
} else {
  // Hide on desktop (spacebar control instead)
  startStopBtn.style.display = "none";
  document.body.addEventListener("keydown", (e) => {
    if (e.code === "Space") handleStartStop();
  });
}


  // click/tap on body toggles (ignore if clicking buttons or inputs or modal)
  function isInteractive(el){
    return el.closest && (el.closest('button') || el.closest('input') || el.closest('.setup-card'));
  }

  // Click — desktop
  // document.body.addEventListener('click', (e) => {
  //   if (isInteractive(e.target)) return;
  //   if (testArea.style.display === 'none') return;
  //   toggleStartStop();
  // });

  // Touch — mobile (use touchstart but prevent double-fire)
  // document.body.addEventListener('touchstart', (e) => {
  //   if (isInteractive(e.target)) return;
  //   if (testArea.style.display === 'none') return;
  //   // prevent default scrolling only when tapping the main area (so test is responsive)
  //   e.preventDefault();
  //   toggleStartStop();
  // }, { passive: false });

  // initialize: show setup modal on first load
  (function init(){
    // ensure inputs sync
    modalNum.value = numInput.value = 10;
    showModal(true);
    resetSession();
  })();

})();
</script>
</body>
</html>

